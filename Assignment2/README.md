# CZ4045 Natural Language Processing
## Assignment 2

Nanyang technological University
School of Computer Science and Engineering
Academic Year 2021/2022 Semester 1

This file contains the source codes for CZ4045 Assignment 2.

This README file is best viewed using a text editor that supports Markdown.

---

## Description

In this assignment, 

## Getting Started
This project runs with the Python 3.8.x interpreter with Pytorch 1.6.0. Add the path of your local python.exe installation to your system PATH variable. Please ensure you have the correct Python version and Pytorch installed. Please note that do not remove any of the generated files from result folders since they will be used for further analysis.

## Program Execution and Desired Outcome

### Question 1
To train the model, run `main.py` file with arguments. The dataset `wikitext-2` has been provided in the folder, simply use the default argument of `--data`. Alternatively, you may use the argument `--data /your path/` to read in your own wikitext-2 dataset. The following command is an example:
```
python main.py --data /your path/ --opt SGD --emsize 8 --save ./model/model_SGD_ngram8_emsize8_nhid200.pt
```

During training, if a keyboard interrupt (Ctrl-C) is received, training is stopped and the current model is evaluated against the test dataset.

The `main.py` script accepts the following arguments:
```
optional arguments:
  -h, --help            show this help message and exit
  --data DATA           location of the data corpus
  --model MODEL         type of neural network (Only FNN model is provided)
  --emsize EMSIZE       size of word embeddings
  --nhid NHID           number of hidden units per layer
  --opt OPT             optimizer type (SGD, Adam, RMSProp)
  --nlayers NLAYERS     number of layers
  --lr LR               initial learning rate
  --clip CLIP           gradient clipping
  --epochs EPOCHS       upper epoch limit
  --batch_size N        batch size
  --bptt BPTT           sequence length
  --dropout DROPOUT     dropout applied to layers (0 = no dropout)
  --tied                tie the word embedding and softmax weights
  --seed SEED           random seed
  --cuda                use CUDA
  --log-interval N      report interval
  --save SAVE           path to save the final model
  --onnx-export ONNX_EXPORT
                        path to export the final model in onnx format
  --nhead NHEAD         the number of heads in the encoder/decoder of the
                        transformer model
```

The best model through validation is generated and stored as `model.pt` by default. It will be found under the new generated folder named `model`.
This model can be used to generate texts. The following command is an example:
``` 
python generate.py --checkpoint ./model/model_SGD_ngram8_emsize8_nhid200.pt --outf ./gen_text/text_SGD_ngram8_emsize8_nhid200.txt 
```
The outcome of the texts generated by your FNN model will be stored under the folder `gen_text` with the named indicated in the argument. 

 
### Question 2
* Change directory accordingly so that the dataset can be accessed:
```
json_path = '../Dataset/reviewSelected100.json' 
``` 
* Download and install the nltk and spaCy packages, as done in previous section
* Execute the Python script
    * The outcome, i.e. list of indicative APs (raw), is printed out
* Refer to the report for detailed analysis on the indicative APs, as well as the criteria of filtering them


## File Structure
```
|-- Qn1                                                     #Source code for Qn1
    |-- gen_text                                            #Folder stores generated text from generate.py
        |-- text_RMSProp_ngram8_emsize200_nhid200.txt
        |-- text_RMSProp_ngram8_emsize200_nhid200.txt
        |-- text_RMSProp_ngram8_emsize200_nhid200.txt
    |-- model                                               #Folder stores trained models from main.py
        |-- model_SGD_ngram8_emsize8_nhid200.pt
        |-- model_Adam_ngram8_emsize8_nhid200.pt
        |-- model_RMSProp_ngram8_emsize8_nhid200.pt
        |-- model_SGD_ngram8_emsize200_nhid200_tie.pt
        |-- model_Adam_ngram8_emsize200_nhid200_tie.pt
        |-- model_RMSProp_ngram8_emsize200_nhid200_tie.pt
    |-- wikitext-2                                          #Dataset used for Qn1
        |-- test.txt
        |-- train.txt
        |-- valid.txt
    |-- generate.py                                         #Code to generate text from language models
    |-- main.py
    |-- model.py
    |-- preprocessing.py                                    #Code to load the raw datasets
|-- Qn2
|-- README.md
```

## Authors
Han Jun - HANJ0030@e.ntu.edu.sg  
Joey Hiew Mun Yee - JOEY0028@e.ntu.edu.sg  
Tao Weijing - D180002@e.ntu.edu.sg  
Wang Yifan - D180003@e.ntu.edu.sg  
Yang Yubei - C180052@e.ntu.edu.sg
